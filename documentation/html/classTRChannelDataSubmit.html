<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.11"/>
<title>Transient Recorder Framework: TRChannelDataSubmit Class Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/javascript">
  $(document).ready(function() { init_search(); });
</script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">Transient Recorder Framework
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.11 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li><a href="pages.html"><span>Related&#160;Pages</span></a></li>
      <li class="current"><a href="annotated.html"><span>Classes</span></a></li>
      <li><a href="files.html"><span>Files</span></a></li>
      <li>
        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="search/mag_sel.png"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.png" alt=""/></a>
          </span>
        </div>
      </li>
    </ul>
  </div>
  <div id="navrow2" class="tabs2">
    <ul class="tablist">
      <li><a href="annotated.html"><span>Class&#160;List</span></a></li>
      <li><a href="classes.html"><span>Class&#160;Index</span></a></li>
      <li><a href="hierarchy.html"><span>Class&#160;Hierarchy</span></a></li>
      <li><a href="functions.html"><span>Class&#160;Members</span></a></li>
    </ul>
  </div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

</div><!-- top -->
<div class="header">
  <div class="summary">
<a href="#pub-methods">Public Member Functions</a> &#124;
<a href="classTRChannelDataSubmit-members.html">List of all members</a>  </div>
  <div class="headertitle">
<div class="title">TRChannelDataSubmit Class Reference</div>  </div>
</div><!--header-->
<div class="contents">

<p>Class for submitting burst data.  
 <a href="classTRChannelDataSubmit.html#details">More...</a></p>

<p><code>#include &lt;<a class="el" href="TRChannelDataSubmit_8h_source.html">TRChannelDataSubmit.h</a>&gt;</code></p>
<div class="dynheader">
Inheritance diagram for TRChannelDataSubmit:</div>
<div class="dyncontent">
 <div class="center">
  <img src="classTRChannelDataSubmit.png" usemap="#TRChannelDataSubmit_map" alt=""/>
  <map id="TRChannelDataSubmit_map" name="TRChannelDataSubmit_map">
</map>
 </div></div>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="pub-methods"></a>
Public Member Functions</h2></td></tr>
<tr class="memitem:aba19501745fa00b6dc99397a91c2dcc2"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classTRChannelDataSubmit.html#aba19501745fa00b6dc99397a91c2dcc2">TRChannelDataSubmit</a> ()</td></tr>
<tr class="memdesc:aba19501745fa00b6dc99397a91c2dcc2"><td class="mdescLeft">&#160;</td><td class="mdescRight">Constructor for the data-submit object.  <a href="#aba19501745fa00b6dc99397a91c2dcc2">More...</a><br /></td></tr>
<tr class="separator:aba19501745fa00b6dc99397a91c2dcc2"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a041b86216ec367a5ced4f082613ffdeb"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classTRChannelDataSubmit.html#a041b86216ec367a5ced4f082613ffdeb">~TRChannelDataSubmit</a> ()</td></tr>
<tr class="memdesc:a041b86216ec367a5ced4f082613ffdeb"><td class="mdescLeft">&#160;</td><td class="mdescRight">Destructor for the data-submit object.  <a href="#a041b86216ec367a5ced4f082613ffdeb">More...</a><br /></td></tr>
<tr class="separator:a041b86216ec367a5ced4f082613ffdeb"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a56bc4643e57dc72f9ac45b7cf9380145"><td class="memItemLeft" align="right" valign="top">bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classTRChannelDataSubmit.html#a56bc4643e57dc72f9ac45b7cf9380145">allocateArray</a> (<a class="el" href="classTRBaseDriver.html">TRBaseDriver</a> &amp;driver, int channel_num, NDDataType_t data_type, int num_samples)</td></tr>
<tr class="memdesc:a56bc4643e57dc72f9ac45b7cf9380145"><td class="mdescLeft">&#160;</td><td class="mdescRight">Set parameters for the array and allocate the NDArray.  <a href="#a56bc4643e57dc72f9ac45b7cf9380145">More...</a><br /></td></tr>
<tr class="separator:a56bc4643e57dc72f9ac45b7cf9380145"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a5b45e73741d73c4504ca5f168063f319"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classTRChannelDataSubmit.html#a5b45e73741d73c4504ca5f168063f319">releaseArray</a> ()</td></tr>
<tr class="memdesc:a5b45e73741d73c4504ca5f168063f319"><td class="mdescLeft">&#160;</td><td class="mdescRight">Release any array.  <a href="#a5b45e73741d73c4504ca5f168063f319">More...</a><br /></td></tr>
<tr class="separator:a5b45e73741d73c4504ca5f168063f319"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:adcf083c25fda553b27d45ed8f7eb6327"><td class="memItemLeft" align="right" valign="top">void *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classTRChannelDataSubmit.html#adcf083c25fda553b27d45ed8f7eb6327">data</a> ()</td></tr>
<tr class="memdesc:adcf083c25fda553b27d45ed8f7eb6327"><td class="mdescLeft">&#160;</td><td class="mdescRight">Returns the data pointer of the array.  <a href="#adcf083c25fda553b27d45ed8f7eb6327">More...</a><br /></td></tr>
<tr class="separator:adcf083c25fda553b27d45ed8f7eb6327"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a81b6626d8588bebabe9f4b28b8ca6029"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classTRChannelDataSubmit.html#a81b6626d8588bebabe9f4b28b8ca6029">submit</a> (<a class="el" href="classTRBaseDriver.html">TRBaseDriver</a> &amp;driver, int channel, int unique_id, double timestamp, epicsTimeStamp epics_ts, <a class="el" href="classTRArrayCompletionCallback.html">TRArrayCompletionCallback</a> *compl_cb)</td></tr>
<tr class="memdesc:a81b6626d8588bebabe9f4b28b8ca6029"><td class="mdescLeft">&#160;</td><td class="mdescRight">Submit the array to AreaDetector.  <a href="#a81b6626d8588bebabe9f4b28b8ca6029">More...</a><br /></td></tr>
<tr class="separator:a81b6626d8588bebabe9f4b28b8ca6029"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><p>Class for submitting burst data. </p>
<p>This object does not have any protection from concurrent use. It is intended to be used within a function on the same thread. Multi-threaded use is possible but external locking is needed in that case. </p>
</div><h2 class="groupheader">Constructor &amp; Destructor Documentation</h2>
<a class="anchor" id="aba19501745fa00b6dc99397a91c2dcc2"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">TRChannelDataSubmit::TRChannelDataSubmit </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Constructor for the data-submit object. </p>
<p>The constructor does not have any parameters and <a class="el" href="classTRChannelDataSubmit.html#a56bc4643e57dc72f9ac45b7cf9380145">allocateArray</a> should be used to allocate the array with the right settings. This allows making an array of these objects.</p>
<p>This class has two major states: without-array (default) and with-array (after a successful <a class="el" href="classTRChannelDataSubmit.html#a56bc4643e57dc72f9ac45b7cf9380145">allocateArray</a>). </p>

</div>
</div>
<a class="anchor" id="a041b86216ec367a5ced4f082613ffdeb"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">TRChannelDataSubmit::~TRChannelDataSubmit </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Destructor for the data-submit object. </p>
<p>It ensures that any array is released at destruction. </p>

</div>
</div>
<h2 class="groupheader">Member Function Documentation</h2>
<a class="anchor" id="a56bc4643e57dc72f9ac45b7cf9380145"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">bool TRChannelDataSubmit::allocateArray </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classTRBaseDriver.html">TRBaseDriver</a> &amp;&#160;</td>
          <td class="paramname"><em>driver</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>channel_num</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">NDDataType_t&#160;</td>
          <td class="paramname"><em>data_type</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>num_samples</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Set parameters for the array and allocate the NDArray. </p>
<p>This may only be called in the without-array state. Upon success, the state changes to with-array.</p>
<p>This function MUST be called with the base and channels drivers unlocked.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">driver</td><td>The <a class="el" href="classTRBaseDriver.html" title="Central class of the Transient Recorder framework for transient recorders (digitizers). ">TRBaseDriver</a> to which the data would be submitted. </td></tr>
    <tr><td class="paramname">channel_num</td><td>Channel number for data. Must be a valid channel number for the <a class="el" href="classTRBaseDriver.html" title="Central class of the Transient Recorder framework for transient recorders (digitizers). ">TRBaseDriver</a>. </td></tr>
    <tr><td class="paramname">data_type</td><td>The AreaDetector data type for the array. </td></tr>
    <tr><td class="paramname">num_samples</td><td>Number of samples for the burst. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>true on success, false on error </dd></dl>

</div>
</div>
<a class="anchor" id="a5b45e73741d73c4504ca5f168063f319"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void TRChannelDataSubmit::releaseArray </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Release any array. </p>
<p>After this the state is witout-array. </p>

</div>
</div>
<a class="anchor" id="adcf083c25fda553b27d45ed8f7eb6327"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void* TRChannelDataSubmit::data </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Returns the data pointer of the array. </p>
<p>This will return NULL if the state is without-array. It is important that the caller checks for NULL before writing data. To write the data, this pointer should be cast to the pointer to type corresponding to the data type of the array as allocated.</p>
<p>This function is not maximally efficient. Avoid calling this in a tight loop and cache the pointer instead.</p>
<dl class="section return"><dt>Returns</dt><dd>The data pointer of the NDArray, or NULL if there is no array. </dd></dl>

</div>
</div>
<a class="anchor" id="a81b6626d8588bebabe9f4b28b8ca6029"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void TRChannelDataSubmit::submit </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classTRBaseDriver.html">TRBaseDriver</a> &amp;&#160;</td>
          <td class="paramname"><em>driver</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>channel</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>unique_id</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>timestamp</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">epicsTimeStamp&#160;</td>
          <td class="paramname"><em>epics_ts</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classTRArrayCompletionCallback.html">TRArrayCompletionCallback</a> *&#160;</td>
          <td class="paramname"><em>compl_cb</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Submit the array to AreaDetector. </p>
<p>It is acceptable to call this in the without-array state, notably after a failed <a class="el" href="classTRChannelDataSubmit.html#a56bc4643e57dc72f9ac45b7cf9380145">allocateArray</a>. After this, the state is without-array (submitting an array implies relasing it).</p>
<p>If called in the with-array state, the driver and channel arguments must be the same as was used in the <a class="el" href="classTRChannelDataSubmit.html#a56bc4643e57dc72f9ac45b7cf9380145">allocateArray</a> call when the array was allocated.</p>
<p>This function will discard the data if disarming has already been initiated.</p>
<p>This function MUST be called with the base and channels drivers unlocked.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">driver</td><td>The <a class="el" href="classTRBaseDriver.html" title="Central class of the Transient Recorder framework for transient recorders (digitizers). ">TRBaseDriver</a> as was passed to <a class="el" href="classTRChannelDataSubmit.html#a56bc4643e57dc72f9ac45b7cf9380145">allocateArray</a>. </td></tr>
    <tr><td class="paramname">channel</td><td>The channel number as was passed to <a class="el" href="classTRChannelDataSubmit.html#a56bc4643e57dc72f9ac45b7cf9380145">allocateArray</a>. </td></tr>
    <tr><td class="paramname">unique_id</td><td>The unique_id for the NDArray. </td></tr>
    <tr><td class="paramname">timestamp</td><td>The timestamp for the NDArray. </td></tr>
    <tr><td class="paramname">epics_ts</td><td>The epicsTimeStamp for the NDArray. </td></tr>
    <tr><td class="paramname">compl_cb</td><td>Optional callback to be called just before submitting the NDArray, after meta-information including timestamps and attributes have been set. This allows overriding any information in the array and adding additional attributes. It is called with the channels port (<a class="el" href="classTRChannelsDriver.html" title="An asynNDArrayDriver-based class though which burst data is submitted into the AreaDetector framework...">TRChannelsDriver</a>) locked. This callbacks also allows inhibiting array submission. </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<hr/>The documentation for this class was generated from the following file:<ul>
<li><a class="el" href="TRChannelDataSubmit_8h_source.html">TRChannelDataSubmit.h</a></li>
</ul>
</div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/>
</a> 1.8.11
</small></address>
</body>
</html>
